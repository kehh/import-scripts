# Find object records that need replacing (otherCollectionsReimport)
SELECT
    o.object_id,
    o.idno,
    cav.value_longtext1 as LegacyID
FROM ca_objects o
    JOIN ca_attributes a ON a.row_id = o.object_id AND a.table_num = 57

    JOIN ca_metadata_elements cme ON a.element_id = cme.element_id
    JOIN ca_attribute_values cav ON a.attribute_id = cav.attribute_id
    JOIN ca_list_items t ON o.type_id = t.item_id
WHERE
    cme.element_code = 'LegacyID'
    AND t.idno != 'Library'
    AND cav.value_longtext1 IN
        (2529, 2813, 2823, 2831, 2832, 2833, 2834, 2836, 2837, 2838, 2942, 3020, 3075, 3920, 7391, 8244, 6899, 7014, 7022, 7065, 7081, 7083, 7712, 8255, 8435, 8483, 8496, 8501, 9319, 13925, 14427, 15191, 15240, 15286, 15782, 15783, 15784, 15785, 15786, 15787, 15788, 15789, 15791, 15792, 19707, 19729, 22794, 26177, 25795, 25796, 25797, 25798, 25799, 25800, 25801, 25802, 25803, 25804, 25818, 25819, 25820, 25821, 25822, 25823, 25828, 25830, 25831, 25833, 25839, 25840, 25841, 25842, 25843, 25844, 25845, 25846, 25847, 25848, 25849, 25850, 25851, 25856, 25857, 25858, 25859, 25860, 25871, 25872, 25873, 25876, 25879, 25881, 25883, 25884, 25885, 25888, 25891, 25892, 25894, 25895, 25896, 25897, 25898, 25900, 25901, 25902, 25903, 25904, 25905, 25906, 25907, 25908, 25909, 25911, 25913, 25914, 25915, 25916, 25917, 25919, 25920, 25921, 25924, 25925, 25926, 25929, 25932, 25934, 25935, 25944, 25949, 25952, 25954, 25956, 25958, 25961, 25963, 25965, 25966, 25968, 25970, 25972, 25975, 25977, 25981, 25982, 25997, 25998, 26017, 26018, 26019, 26021, 26022, 26023, 26024, 26025, 26026, 26027, 26028, 26029, 26031, 26032, 26033, 26084, 26085, 26086, 26087, 26088, 26089, 26090, 26091, 26092, 26093, 26094, 26096, 26102, 26103, 26104, 26105, 26107, 26112, 26113, 26114, 26115, 26116, 26117, 26118, 26136, 26137, 26138, 26139, 26140, 26141, 26142, 26144, 26145, 26147, 26148, 26149, 26150, 26153, 26156, 26159, 26160, 26163, 26164, 26165, 26167, 26168, 26170, 26172, 26173, 26174, 26178, 26179, 26182, 26183, 26184, 26185, 26186, 26187, 26201, 26202, 26203, 26204, 26205, 26210, 26211, 26222, 26225, 26230, 26233, 26238, 26538, 26539, 26540, 26541, 26542, 26543, 26544, 26545, 26546, 26547, 26548, 26549, 26550, 26590, 26591, 26592, 26593, 26594, 26595, 26596, 26597, 26598, 26599, 26612, 26613, 26614, 26615, 26616, 26617, 26618, 26619, 26620, 26621, 26622, 26645, 26647, 26650, 26653, 26656, 26658, 26661, 26662, 26663, 26664, 26665, 26666, 26667, 26668, 26669, 26670, 26671, 26672, 26673, 26674, 26675, 26677, 26678, 26679, 26680, 26681, 26682, 26683, 26684, 26685, 26686, 26687, 26688, 26689, 26690, 26691, 26692, 26693, 26694, 26695, 26696, 26697, 26698, 26699, 26700, 26701, 26702, 26703, 26730, 26731, 26734, 26736, 26738, 26741, 26743, 26747, 26749, 26751, 26826, 26829, 26831, 26833, 26834, 26835, 26837, 26839, 26840, 26843, 26845, 26847, 26849, 26855, 26858, 26859, 26860, 26861, 26862, 26865, 26867, 26869, 26870, 26871, 26872, 26873, 26874, 26875, 26876, 26877, 26878, 26879, 26880, 26881, 26882, 26883, 26932, 26933, 26934, 26935, 26936, 26937, 26938, 26939, 26940, 26941, 26942, 26943, 26945, 26972, 26973, 26974, 26975, 26976, 26978, 26979, 26980, 26982, 26984, 26985, 26986, 26988, 26989, 26990, 27087, 27247, 27248, 27249, 27250, 27251, 27252, 27253, 27254, 27256, 27257, 27258, 27261, 27263, 27265, 27266, 27269, 27270, 28080, 28397, 28814, 28815, 28816, 28817, 28818, 28821, 28822, 28823, 28824, 28825, 28826, 28827, 28828, 28906, 28907, 28910, 15, 46, 27721, 38, 26795, 229, 3747)
GROUP BY object_id;
# Find other records that have no attributes
# Records: 6
SELECT
    o.object_id,
    o.idno,
    l.name,
    t.idno
FROM ca_objects o
    JOIN ca_object_labels l USING (object_id)
    JOIN ca_list_items t ON o.type_id = t.item_id AND t.idno != 'library'
    LEFT JOIN ca_attributes a ON a.row_id = o.object_id AND a.table_num = 57
WHERE
    a.attribute_id IS NULL
GROUP BY object_id;
